```r

```

# Handbook of Broadleaf.Korean.pine.LAI

#### 

## 软件包简介

叶面积指数（LAI）指单位水平地面面积上总叶面积的一半，为植物冠层结构的最常用参数之一。我团队提出了一种基于分层泰森多边形估算复层林叶面积指数的方法，相较于传统基于公式的叶面积指数估计方法，该法可通过泰森多边形估算林分中各林木的树冠下叶面积指数，并在此基础上较为准确的计算林分中任意位点处的若干与叶面积指数相关的冠层结构参数（局部叶面积指数、局部叶面积指数标注差、不同树种对局部叶面积指数的贡献率等）。

我团队将基于分层泰森多边形估算复层林叶面积指数的方法用于阔叶红松林叶面积指数的估算，开发了R包Broadleaf.Korean.pine.LAI，该软件包：（1）可以定量分析林分中以任意位点为中心，一定半径的圆内的叶面积指数，并给出不同树种在叶面积指数中的占比，针叶树种与阔叶树种在叶面积指数中的占比；（2）可以分析林内任意位点的局部标准差，以此结合该位点的叶面积指数判断位点位置的斑块类型（针叶树冠、阔叶树冠、针阔混交树冠、林缘、林隙）；（3）可以用于分析阔叶红松林内叶面积指数的空间自相关性。

## 依赖关系

本包依赖于 sp ；gstat ；tcltk ；ggplot2 ；deldir ；grDevices；stats 运行前请先安装

## 软件包安装方式

library(devtools);install_github(“DuXinChina/Broadleaf.Korean.pine.LAI/Broadleaf.Korean.pine.LAI”)

## 1 示例数据展示

示例数据为虚拟数据，数据为50m×50m样地，样地中包含色木、紫椴、冷杉、红松四种树种的空间坐标、胸径、树高信息。依据树高，将阔叶红松林分为不同林层。其中，下木层树高小于10m；亚林层树高为10m—16m；主林层树高为16m—30m；超冠层树高大于30m。虚拟数据中，超冠层包含两株红松，为随机分布；主林层中包含15株红松、10株冷杉、10株紫椴、5株色木，均为随机分布；亚林层中包含50株色木，为以（10,40）和（40,10）为中心的各25株的聚集分布；林下层包含四类树种各20株植株，各树种在小尺度为聚集分布，在大尺度为随机分布。超冠层中，林木胸径大于60cm；主林层中，林木胸径为30cm—60 cm；亚林层中林木胸径为10 cm-30cm；下木层胸径小于10 cm。

数据中x与y列分别为林木横纵坐标、DBH为胸径、H为树高、Species列为树种种名。

Species列可包含的常见树种种名为HS 红松、YS 云杉、LS 冷杉、ZD 紫椴、KD 糠椴、MGL 蒙古栎、SQL 水曲柳、HTQ 胡桃楸、HBL 黄檗、SMQ 色木槭、QKQ 青楷槭。HKQ 花楷槭、JSQ 假色槭、NJQ 拧筋槭、BNQ 白牛槭、CY 春榆、BH 白桦、HH 怀槐、FH 枫桦、LYY 裂叶榆、QT 其他树种。

```R
data = Broadleaf.Korean.pine.LAI::b
data
##              x          y       DBH  H Species
## 1   33.4288480 18.9819806 65.580755 35      HS
## 2    6.4346078 42.0391756 66.180769 35      HS
## 3   18.1460637 19.2660497 52.264410 25      HS
## 4   27.5928278 13.8968076 32.366493 25      HS
## 5    6.1081642 25.6396705 35.555799 25      HS
## 6   39.5111778  5.1855691 53.037166 25      HS
## 7   18.2991147 36.4641006 31.796712 25      HS
## 8   25.6670756  4.6233300 31.566986 25      HS
## 9   25.2746910  5.0032010 34.373929 25      HS
## 10  11.1674790  8.0279473 58.859233 25      HS
## 11  10.9212414 11.5923407 35.492684 25      HS
## 12  22.6771733 12.8692340 50.351396 25      HS
## 13   3.1528245 40.5892981 40.749832 25      HS
## 14  48.9035375 10.3960484 43.531746 25      HS
## 15  44.4565091 36.6393705 30.292931 25      HS
## 16  18.4087182 19.8480956 34.429790 25      HS
## 17  37.7821442 18.2801837 38.516582 25      HS
## 18  10.2223582  0.3512422 35.396181 25      LS
## 19  23.3121148  6.1817106 40.818709 25      LS
## 20   3.7540585 32.3250375 33.630106 25      LS
## 21  28.3364101  6.5744882 39.985535 25      LS
## 22   6.8510692  9.6053103 54.610498 25      LS
## 23  33.3752221 36.7657443 34.227696 25      LS
## 24  44.9338280  0.6791399 56.573134 25      LS
## 25   1.5318491 24.5214906 34.453612 25      LS
## 26  40.2367382 11.2009961 58.903647 25      LS
## 27  16.3113690 25.0485350 48.073396 25      LS
## 28  31.4198530  6.2785452 52.088891 25      ZD
## 29  46.0771567 27.8802443 51.481795 25      ZD
## 30   0.2149013 46.6323809 59.699024 25      ZD
## 31  48.3191063 30.0955467 52.972707 25      ZD
## 32  25.6461456  8.1469459 30.973053 25      ZD
## 33  37.0948580 34.3532822 45.913191 25      ZD
## 34  15.7041204 49.4823055 57.685524 25      ZD
## 35   9.0926424 24.8328917 45.382739 25      ZD
## 36  10.1880918 36.0375070 58.164637 25      ZD
## 37   6.6190212 46.7338556 44.880348 25      ZD
## 38  27.8663572 22.0768596 51.736290 25     SMQ
## 39  15.3366110 16.2149379 42.419761 25     SMQ
## 40  27.9341496 11.3119979 57.306566 25     SMQ
## 41  27.9685288 10.7013771 31.988869 25     SMQ
## 42  30.4606082  4.4862904 31.223996 25     SMQ
## 43  27.4182794  5.0037950 20.837063 15     SMQ
## 44  44.4396113 28.8874433 10.625898 15     SMQ
## 45  34.8701260 10.9891497 26.209086 15     SMQ
## 46  29.3663570 24.8532922 21.750956 15     SMQ
## 47  39.0940332 21.3669462 14.558203 15     SMQ
## 48  37.8461923  0.8798485 25.238661 15     SMQ
## 49  40.8974968 15.1046335 15.410212 15     SMQ
## 50  43.7170631 12.4452323 24.453914 15     SMQ
## 51  44.2418135 15.5011735 19.805805 15     SMQ
## 52  34.7943280 15.7893710 13.230423 15     SMQ
## 53  44.7095683 16.8244097 11.873488 15     SMQ
## 54  32.1441950 10.4155232 16.800018 15     SMQ
## 55  40.1892333 20.6559082 24.111454 15     SMQ
## 56  45.1569390 11.7849286 29.909211 15     SMQ
## 57  31.1358896  4.4016615 25.619205 15     SMQ
## 58  41.9316033 12.6385274 19.933430 15     SMQ
## 59  38.1089669  6.2206536 27.308530 15     SMQ
## 60  44.1061557 15.5097960 13.451536 15     SMQ
## 61  43.9375359  4.8815030 15.789073 15     SMQ
## 62  43.9779725  1.6313955 16.654748 15     SMQ
## 63  42.8673806 10.6359013 23.262358 15     SMQ
## 64  40.8195774  8.6401999 29.290362 15     SMQ
## 65  35.0804810 24.0241466 22.261274 15     SMQ
## 66  23.9579239 14.2034792 12.860445 15     SMQ
## 67  45.5492528 13.8757384 28.784073 15     SMQ
## 68  27.7498276 42.5004315 27.557451 15     SMQ
## 69  16.9513238 39.2511895 11.311346 15     SMQ
## 70   7.8428609 35.1662446 18.100418 15     SMQ
## 71  21.5821916 46.1810341 15.722701 15     SMQ
## 72   9.8932887 38.4724617 18.591866 15     SMQ
## 73  21.4302064 47.5721941 24.531588 15     SMQ
## 74  16.0871787 38.7437988 17.157289 15     SMQ
## 75  27.3022366 30.3321379 21.895134 15     SMQ
## 76  11.6537314 37.9788635 17.060371 15     SMQ
## 77   8.9436178 40.0632726 17.962532 15     SMQ
## 78   6.2872774 39.4914437 28.778782 15     SMQ
## 79   5.3213029 47.4720506 26.740215 15     SMQ
## 80   4.4828161 40.1074313 23.338306 15     SMQ
## 81  17.4019105 37.3673022 22.306889 15     SMQ
## 82  14.4704528 41.0565769 20.476022 15     SMQ
## 83  15.4274825 48.2122797 19.459245 15     SMQ
## 84  10.7972558 43.9528950 24.105329 15     SMQ
## 85   1.3316003 48.4359719 27.001667 15     SMQ
## 86  19.4026872 38.7502684 24.929608 15     SMQ
## 87  20.8525298 43.6054503 12.541657 15     SMQ
## 88  10.3695183 42.6703659 20.995959 15     SMQ
## 89  11.9001001 23.5515179 25.591832 15     SMQ
## 90   7.8739939 39.0204771 16.820479 15     SMQ
## 91  12.9090867 40.7360448 15.755752 15     SMQ
## 92  14.8874215 28.9533239 19.382401 15     SMQ
## 93  39.6436424 40.9811422  9.934820  8      LS
## 94  49.6122418 34.0210738  8.551500  8      LS
## 95  46.5867969 37.3322312  5.193316  8      LS
## 96  49.0000000 48.3085792  8.632041  8      LS
## 97  29.0852543 41.1179223  6.165639  8      LS
## 98  29.0206565 34.8073513  9.694307  8      LS
## 99  28.7770563 37.6178602  9.306080  8      LS
## 100 38.6189406 33.9430026  8.822112  8      LS
## 101 45.9365553 22.4422532  6.603459  8      LS
## 102 36.6124557 23.8282281  6.482322  8      LS
## 103 42.8625806  7.1329634  8.337840  8      LS
## 104 32.6357700 21.9731506  7.542603  8      LS
## 105 11.7305549  2.2269401  6.781676  8      LS
## 106  5.1875622  1.0000000  8.702628  8      LS
## 107  8.4335608  0.1246017  9.224902  8      LS
## 108  6.2689242  3.7764784  5.028092  8      LS
## 109 49.7399440 13.3581418  5.351386  8      LS
## 110 44.1681187 13.2980574  9.975786  8      LS
## 111 49.0000000 21.0523839  7.792711  8      LS
## 112 47.4105839  1.0000000  8.252535  8      LS
## 113 49.0000000  1.0000000  9.106646  8      HS
## 114 48.3429683  5.6185863  7.605254  8      HS
## 115 40.5465709  8.1345473  8.666798  8      HS
## 116 49.0000000 11.0004526  9.061282  8      HS
## 117  6.2794533  4.2384272  5.919919  8      HS
## 118  1.0000000  5.9588289  7.419849  8      HS
## 119  3.8418102 12.5395119  6.657954  8      HS
## 120  1.7257937  7.9206185  8.538493  8      HS
## 121 41.8513062 16.1607322  7.772832  8      HS
## 122 40.2428301 19.8903321  5.406923  8      HS
## 123 36.5047511 15.0316257  9.628256  8      HS
## 124 36.7982127 11.3218356  9.553490  8      HS
## 125 31.1297617 16.2011382  8.440440  8      HS
## 126 36.6997820 25.2196392  7.903824  8      HS
## 127 32.7186422 11.4235729  9.530176  8      HS
## 128 28.2869781 20.5159761  6.201615  8      HS
## 129 17.7794649 14.8297948  8.094559  8      HS
## 130 13.0119315 15.5301695  8.087604  8      HS
## 131 12.8823991 15.8329528  8.933832  8      HS
## 132 10.1283477 10.6649023  5.769270  8      HS
## 133  3.0805107 29.2901996  8.609461  8      ZD
## 134  0.9071648 25.2446763  8.010450  8      ZD
## 135  1.0000000 29.8599316  5.312565  8      ZD
## 136  1.0000000 31.6702470  8.310919  8      ZD
## 137 18.3311714 49.0000000  7.540457  8      ZD
## 138 21.4111116 46.7843710  5.504480  8      ZD
## 139 18.8694693 43.5405025  8.373520  8      ZD
## 140 19.7880615 46.1762995  5.829197  8      ZD
## 141  7.4560338 44.4200915  8.199286  8      ZD
## 142 16.6670340 47.2940320  6.212923  8      ZD
## 143 12.5297550 49.0000000  8.027718  8      ZD
## 144 15.8983970 49.0000000  7.926028  8      ZD
## 145 38.9231748 41.7665160  6.291640  8      ZD
## 146 37.4657599 47.2459319  8.682012  8      ZD
## 147 49.6668905 39.7330850  8.203196  8      ZD
## 148 31.8817342 39.6527677  5.795613  8      ZD
## 149  5.6448613 28.8535785  5.703050  8      ZD
## 150  4.2739190 17.6424662  6.565414  8      ZD
## 151 10.9522913 19.9384604  9.095775  8      ZD
## 152  9.6877684 14.2428889  6.697895  8      ZD
## 153  7.8820318 49.0000000  9.916860  8     SMQ
## 154  1.0000000 44.4448761  6.899585  8     SMQ
## 155  2.3695873 48.7241619  6.060310  8     SMQ
## 156  5.6845312 42.1728318  7.417518  8     SMQ
## 157 20.6701393 33.8747094  8.585438  8     SMQ
## 158 17.3413093 28.6130006  7.200311  8     SMQ
## 159 24.7963305 26.5485412  6.546525  8     SMQ
## 160 25.8814922 23.0839561  7.570419  8     SMQ
## 161 38.1404212 18.1701050  7.064143  8     SMQ
## 162 44.4997075 17.7732229  8.575503  8     SMQ
## 163 41.8010491 30.4660159  8.362883  8     SMQ
## 164 43.8052430 18.7144681  7.256104  8     SMQ
## 165 27.9742202 48.2190508  7.243758  8     SMQ
## 166 27.1037613 49.0000000  8.991668  8     SMQ
## 167 33.9898945 48.8409792  8.534445  8     SMQ
## 168 37.3406029 49.0000000  6.711967  8     SMQ
## 169 10.4386867 34.3300143  5.309605  8     SMQ
## 170  8.0524403 27.1832789  9.161863  8     SMQ
## 171  1.0000000 25.2146483  9.680147  8     SMQ
## 172 12.1497107 29.6801073  6.772546  8     SMQ
```

## 2 示例

### 2.1 LAI.single(a,b,r)

2.1.1功能介绍： 基于传统方法，计算阔叶红松林内以任意位点为中心，一定半径的圆形区域内的叶面积指数，并给出不同树种在叶面积指数中的占比，及针叶树种与阔叶树种叶面积指数的占比。

2.1.2参数意义： a—需要计算叶面积指数的位点坐标 b—样地中林木的坐标、树种、胸径、树高信息 r—以位点中心圆的半径

2.1.3例：

计算以（25,25）为中心5m为半径的圆内的叶面积

```R
a=matrix(c(25,25),1,2)
colnames(a)=c("x","y")
a
##       x  y
## [1,] 25 25
b=Broadleaf.Korean.pine.LAI::b[,-4]
head(b)
##           x         y      DBH Species
## 1 33.428848 18.981981 65.58075      HS
## 2  6.434608 42.039176 66.18077      HS
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
Broadleaf.Korean.pine.LAI::LAI.single(a=a,b=b,r=5)
## $LAI
## [1] 12.23283
## 
## $Species_LAI
##      HS_LAI LS_LAI YS_LAI ZD_LAI KD_LAI MGL_LAI SQL_LAI HTQ_LAI HBL_LAI
## [1,]      0      0      0      0      0       0       0       0       0
##       SMQ_LAI QKQ_LAI HKQ_LAI JSQ_LAI NJQ_LAI BNQ_LAI CY_LAI BH_LAI HH_LAI
## [1,] 12.23283       0       0       0       0       0      0      0      0
##      FH_LAI LYY_LAI QT_LAI
## [1,]      0       0      0
## 
## $N_B_LAI
##      Needles_LAI Broadleaf_LAI N_L_percent B_L_percent
## [1,]           0      12.23283           0         100
```

总叶面积指数为12.23283、树种色木槭叶面积为12.23283、阔叶树种叶面积12.23283、阔叶占比100%

### 2.2 LAI.mult(a,b,r)

2.2.1功能介绍： 计算阔叶红松林内的多个位点为中心，一定半径的圆形区域内的叶面积指数，针叶树种与阔叶树种叶面积指数以及针阔叶面积分别的占比。

2.2.2参数意义：

a—需要计算叶面积指数的多个位点坐标

b—样地中林木的坐标、树种、胸径、树高信息

r—以位点中心圆的半径

2.2.3例：

计算多个样点的叶面积指数，针叶叶面积指数，阔叶叶面积指数以及针阔叶树种叶面积指数的占比

```R
a=matrix(runif(10,5,45),5,2)
colnames(a)=c("x","y")
a=as.data.frame(a)
a
##          x        y
## 1 38.91460 35.15677
## 2 14.28745 40.59848
## 3 39.69378 21.03377
## 4 28.64947 12.99103
## 5 26.09728 20.16785
b=Broadleaf.Korean.pine.LAI::b[,-4]
head(b)
##           x         y      DBH Species
## 1 33.428848 18.981981 65.58075      HS
## 2  6.434608 42.039176 66.18077      HS
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
Broadleaf.Korean.pine.LAI::LAI.mult(a=a,b=b,r=5)
## $LAI
##          x        y       LAI
## 1 38.91460 35.15677  5.091377
## 2 14.28745 40.59848 15.518945
## 3 39.69378 21.03377  8.615559
## 4 28.64947 12.99103 21.156389
## 5 26.09728 20.16785  9.898300
## 
## $B_N_LAI
##          x        y Needles_LAI Broadleaf_LAI N_L_percent B_L_percent
## 1 38.91460 35.15677   0.1265253      4.964852    2.485090    97.51491
## 2 14.28745 40.59848   0.0000000     15.518945    0.000000   100.00000
## 3 39.69378 21.03377   4.2260056      4.389554   49.050856    50.94914
## 4 28.64947 12.99103   3.5088335     17.647555   16.585220    83.41478
## 5 26.09728 20.16785   0.1428886      9.755411    1.443568    98.55643
```

### 2.3 Plot.LAI.Krig (minx,maxx,miny,maxy,b,seq,r)

2.3.1功能介绍： 绘制阔叶红松林叶面积指数的克里格插值图。计算阔叶红松林叶面积指数半变异函数

2.3.2参数意义：

minx—绘制克里格插值图的最小横坐标

maxx—绘制克里格插值图的最大横坐标

miny—绘制克里格插值图的最小纵坐标

maxy—绘制克里格插值图的最大纵坐标

b—样地中的林木坐标、树种、胸径

seq—绘制克里格图的空间分辨率

r—以位点中心圆的半径

2.3.3例：

\####

```R
b=Broadleaf.Korean.pine.LAI::b[,-4]
head(b)
##           x         y      DBH Species
## 1 33.428848 18.981981 65.58075      HS
## 2  6.434608 42.039176 66.18077      HS
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
head(b)
##           x         y      DBH Species
## 1 33.428848 18.981981 65.58075      HS
## 2  6.434608 42.039176 66.18077      HS
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
p=Broadleaf.Korean.pine.LAI::Plot.LAI.Krig(5,45,5,45,b=b,seq=20,r=3)
##   model    psill    range
## 1   Nug   0.0000 0.000000
## 2   Sph 146.1265 7.064373
```

![2.3.1](https://github.com/DuXinChina/Broadleaf.Korean.pine.LAI/blob/main/handbook/assets/2.3.1.png)

```R
## [1] "Coefficient_of_Determination= 0.979977519972073"
## [using ordinary kriging]
```

![2.3.2](https://github.com/DuXinChina/Broadleaf.Korean.pine.LAI/blob/main/handbook/assets/2.3.2.png)

```R
p1=p+geom_vline(xintercept = c(5,45),linetype=2)+geom_hline(yintercept =c(5,45),linetype=2)
p1=p+scale_x_continuous(expand= c(0, 5))+scale_y_continuous(expand= c(0, 5))
## Scale for 'x' is already present. Adding another scale for 'x', which will
## replace the existing scale.
## Scale for 'y' is already present. Adding another scale for 'y', which will
## replace the existing scale.
p2=p1+geom_point(data=b,aes(x=x,y=y),size=b$DBH/8,col="grey4",alpha=0.2)+scale_x_continuous(expand= c(0, 0))+scale_y_continuous(expand= c(0, 0))
## Scale for 'x' is already present. Adding another scale for 'x', which will
## replace the existing scale.
## Scale for 'y' is already present. Adding another scale for 'y', which will
## replace the existing scale.
p2
```

![2.3.3](https://github.com/DuXinChina/Broadleaf.Korean.pine.LAI/blob/main/handbook/assets/2.3.3.png)

### **2.4 Standing_Forest_LAI(minx,maxx,miny,maxy,b)**

2.4.1功能介绍：

计算阔叶红松林全林分的叶面积指数，并给出不同树种叶面积指数的量与占比，以及针、阔叶树种叶面积指数的量与占比。

2.4.2 参数意义：

minx—计算叶面积指数样地横坐标最小边界

maxx—计算叶面积指数样地横坐标最大边界

miny—计算叶面积指数样地纵坐标最小边界

maxy—计算叶面积指数样地纵坐标最大边界

b—林木分布信息

2.4.3例：

```R
b=Broadleaf.Korean.pine.LAI::b[,-4]
head(b)
##           x         y      DBH Species
## 1 33.428848 18.981981 65.58075      HS
## 2  6.434608 42.039176 66.18077      HS
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
Broadleaf.Korean.pine.LAI::Standing_Forest_LAI(minx=5,maxx=45,miny=5,maxy=45,b)
## $LAI
## [1] 11.89552
## 
## $Species_LAI
##        HS_LAI   LS_LAI YS_LAI   ZD_LAI KD_LAI MGL_LAI SQL_LAI HTQ_LAI HBL_LAI
## [1,] 3.948259 1.242444      0 1.352644      0       0       0       0       0
##       SMQ_LAI QKQ_LAI HKQ_LAI JSQ_LAI NJQ_LAI BNQ_LAI CY_LAI BH_LAI HH_LAI
## [1,] 5.352169       0       0       0       0       0      0      0      0
##      FH_LAI LYY_LAI QT_LAI
## [1,]      0       0      0
## 
## $N_B_LAI
##      Needles_LAI Broadleaf_LAI N_L_percent B_L_percent
## [1,]    5.190703      6.704814    43.63579    56.36421
```

林分叶面积指数11.896。红松叶面积指数3.948；冷杉叶面积指数1.242；紫椴叶面积指数1.353；色木叶面积指数5.352。针叶树叶面积指5.191；阔叶树叶面积指数6.705。针叶树种叶面积指数占比43.636%；阔叶树种叶面积指数占比56.364%。

### **2.5 LSD_LAI(a,b,r,Lr)**

2.5.1功能介绍：

在以一定半径圆的面积为分辨率计算阔叶红松林叶面指数后。计算以某一位点为中心，一定半径圆内叶面积指数的局部标准差。通常情况下，林缘处及大树小树的冠层交错处的叶面积指数具有较大的局部标准差。

2.5.2参数意义：

a—需要计算叶面积指数局部标准差的位点坐标

b—林木分布信息及胸径、树高

r—计算林木内叶面积指数时所用圆的半径

Lr—计算位点叶面积指数局部标准差时所用圆的半径

2.5.3例：

```R
a=data.frame(28,25)
colnames(a)=c("x","y")
a
##    x  y
## 1 28 25
b=Broadleaf.Korean.pine.LAI::b[,-4]
head(b)
##           x         y      DBH Species
## 1 33.428848 18.981981 65.58075      HS
## 2  6.434608 42.039176 66.18077      HS
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
result=Broadleaf.Korean.pine.LAI::LSD_LAI(a=a,b=b,r=3,Lr=1.5)
formattable::formattable(result)
```

|    x |    y |  LSD_LAI |
| ---: | ---: | -------: |
|   28 |   25 | 13.82343 |

### **2.6 LSD_LAI_mult(a,b,r,Lr)**

2.6.1功能介绍：

计算多个位点叶面积指数的局部标准差

2.6.2参数意义：

a—需要计算叶面积指数局部标准差的位点坐标

b—林木分布信息及胸径、树高

r—计算林木内叶面积指数时所用圆的半径

Lr—计算位点叶面积指数局部标准差时所用圆的半径

2.6.3例：

```R
a=matrix(runif(10,5,45),5,2)
colnames(a)=c("x","y")
a=as.data.frame(a)
a
##          x        y
## 1 40.64936 42.30322
## 2 11.51197 17.67519
## 3 40.79742 42.22123
## 4 44.44773 21.15210
## 5 44.69300 41.35127
b=Broadleaf.Korean.pine.LAI::b[,-4]
head(b)
##           x         y      DBH Species
## 1 33.428848 18.981981 65.58075      HS
## 2  6.434608 42.039176 66.18077      HS
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
result=Broadleaf.Korean.pine.LAI::LSD_LAI_mult(a=a,b=b,r=3,Lr=1.5)
formattable::formattable(result)
```

|        x |        y |   LSD_LAI |
| -------: | -------: | --------: |
| 40.64936 | 42.30322 | 0.1492563 |
| 11.51197 | 17.67519 | 5.1250428 |
| 40.79742 | 42.22123 | 0.1492563 |
| 44.44773 | 21.15210 | 2.3580926 |
| 44.69300 | 41.35127 | 0.0000000 |

### **2.7 Plot.LSD_LAI.Krig(minx,maxx,miny,maxy,b,seq,r,Lr)**

2.7.1功能介绍：

绘制阔叶红松林叶面积指数局部标准差的克里格插值图。计算阔叶红松林叶面积指数局部标准差的半变异函数。

2.7.2参数意义：

minx—绘制克里格插值图的最小横坐标

maxx—绘制克里格插值图的最大横坐标

miny—绘制克里格插值图的最小纵坐标

maxy—绘制克里格插值图的最大纵坐标

b—样地中的林木坐标、树种、胸径

seq—绘制克里格图的空间分辨率

r—计算林分叶面积指数时以位点中心圆的半径

Lr—计算林分叶面积指数局部标准差时取样圆的半径

2.7.3例：

```R
p=Broadleaf.Korean.pine.LAI::Plot.LSD_LAI.Krig(minx=5,maxx=45,miny=5,maxy=45,b=b,seq=40,r=3,Lr=1)
##   model     psill    range
## 1   Nug  0.371586 0.000000
## 2   Sph 14.475010 3.210693
```

![2.7.1](https://github.com/DuXinChina/Broadleaf.Korean.pine.LAI/blob/main/handbook/assets/2.7.1.png)

```
## [1] "Coefficient_of_Determination= 0.734423332692097"
## [using ordinary kriging]
```

![2.7.2](https://github.com/DuXinChina/Broadleaf.Korean.pine.LAI/blob/main/handbook/assets/2.7.2.png)

```
p1=p+geom_vline(xintercept = c(5,45),linetype=2)+geom_hline(yintercept =c(5,45),linetype=2)
p1=p+scale_x_continuous(expand= c(0, 5))+scale_y_continuous(expand= c(0, 5))
## Scale for 'x' is already present. Adding another scale for 'x', which will
## replace the existing scale.
## Scale for 'y' is already present. Adding another scale for 'y', which will
## replace the existing scale.
p2=p1+geom_point(data=b,aes(x=x,y=y),size=b$DBH/8,col="grey4",alpha=0.2)+scale_x_continuous(expand= c(0, 0))+scale_y_continuous(expand= c(0, 0))
## Scale for 'x' is already present. Adding another scale for 'x', which will
## replace the existing scale.
## Scale for 'y' is already present. Adding another scale for 'y', which will
## replace the existing scale.
p2
```

![2.7.3](https://github.com/DuXinChina/Broadleaf.Korean.pine.LAI/blob/main/handbook/assets/2.7.3.png)

### **2.8 Voronoi.LAI(minx,maxx,miny,maxy,boundary,b,r)**

2.8.1功能介绍：

基于泰森多边形法计算林地内（单一林层）各株树木下的叶面积指数。

2.8.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

b—样地中的林木坐标、树种、胸径

r—将在林分中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为添加样点构成泰森多边形外接圆的半径

2.8.3例：

```R
b=Broadleaf.Korean.pine.LAI::b
b=subset(b,b$H<10)
b=b[,-4]
head(b)
##           x        y      DBH Species
## 93 39.64364 40.98114 9.934820      LS
## 94 49.61224 34.02107 8.551500      LS
## 95 46.58680 37.33223 5.193316      LS
## 96 49.00000 48.30858 8.632041      LS
## 97 29.08525 41.11792 6.165639      LS
## 98 29.02066 34.80735 9.694307      LS
result=Broadleaf.Korean.pine.LAI::Voronoi.LAI(minx=0,maxx=50,miny=0,maxy=50,boundary=5,b=b,r=2)
## deldir 0.1-25
## 
##      PLEASE NOTE:  The components "delsgs" and "summary" of the
##  object returned by deldir() are now DATA FRAMES rather than
##  matrices (as they were prior to release 0.0-18).
##  See help("deldir").
##  
##      PLEASE NOTE: The process that deldir() uses for determining
##  duplicated points has changed from that used in version
##  0.0-9 of this package (and previously). See help("deldir").
formattable::formattable(result)
```

|      |         x |         y |      DBH | Species | deldir_area |       LAI |
| :--- | --------: | --------: | -------: | ------: | ----------: | --------: |
| 1151 | 40.546571 |  8.134547 | 8.666798 |      HS |   11.330023 | 1.8280989 |
| 1211 | 41.851306 | 16.160732 | 7.772832 |      HS |    7.446677 | 2.2787643 |
| 1221 | 40.242830 | 19.890332 | 5.406923 |      HS |   10.204645 | 0.8555496 |
| 1231 | 36.504751 | 15.031626 | 9.628256 |      HS |   11.022876 | 2.2782009 |
| 1241 | 36.798213 | 11.321836 | 9.553490 |      HS |   10.574174 | 2.3412161 |
| 1251 | 31.129762 | 16.201138 | 8.440440 |      HS |   10.092394 | 1.9552015 |
| 1261 | 36.699782 | 25.219639 | 7.903824 |      HS |    9.938405 | 1.7604941 |
| 1271 | 32.718642 | 11.423573 | 9.530176 |      HS |    9.631383 | 2.5589181 |
| 1281 | 28.286978 | 20.515976 | 6.201615 |      HS |   11.211359 | 1.0009891 |
| 1291 | 17.779465 | 14.829795 | 8.094559 |      HS |    9.916840 | 1.8430610 |
| 1301 | 13.011931 | 15.530169 | 8.087604 |      HS |    5.397890 | 3.3806904 |
| 1311 | 12.882399 | 15.832953 | 8.933832 |      HS |    4.515785 | 4.8487324 |
| 1321 | 10.128348 | 10.664902 | 5.769270 |      HS |    8.797683 | 1.1175200 |
| 931  | 39.643642 | 40.981142 | 9.934820 |      LS |    4.051210 | 3.1371516 |
| 971  | 29.085254 | 41.117922 | 6.165639 |      LS |   11.127536 | 0.4251923 |
| 981  | 29.020656 | 34.807351 | 9.694307 |      LS |    7.572667 | 1.5952402 |
| 991  | 28.777056 | 37.617860 | 9.306080 |      LS |    9.899437 | 1.1212409 |
| 1001 | 38.618941 | 33.943003 | 8.822112 |      LS |    9.563267 | 1.0391086 |
| 1021 | 36.612456 | 23.828228 | 6.482322 |      LS |    7.471493 | 0.7024784 |
| 1031 | 42.862581 |  7.132963 | 8.337840 |      LS |    7.961299 | 1.1104450 |
| 1041 | 32.635770 | 21.973151 | 7.542603 |      LS |   12.589005 | 0.5705859 |
| 1101 | 44.168119 | 13.298057 | 9.975786 |      LS |   12.594981 | 1.0177107 |
| 1391 | 18.869469 | 43.540503 | 8.373520 |      ZD |    7.414297 | 3.2721277 |
| 1411 |  7.456034 | 44.420091 | 8.199286 |      ZD |   11.553485 | 2.0290078 |
| 1451 | 38.923175 | 41.766516 | 6.291640 |      ZD |    8.042431 | 1.8919493 |
| 1481 | 31.881734 | 39.652768 | 5.795613 |      ZD |   11.000001 | 1.2097613 |
| 1491 |  5.644861 | 28.853578 | 5.703050 |      ZD |    9.434602 | 1.3739077 |
| 1511 | 10.952291 | 19.938460 | 9.095775 |      ZD |    9.683829 | 2.8674346 |
| 1521 |  9.687768 | 14.242889 | 6.697895 |      ZD |   13.224945 | 1.2742414 |
| 1561 |  5.684531 | 42.172832 | 7.417518 |     SMQ |    8.816524 | 3.1931293 |
| 1571 | 20.670139 | 33.874709 | 8.585438 |     SMQ |    9.701815 | 3.7103160 |
| 1581 | 17.341309 | 28.613001 | 7.200311 |     SMQ |   11.358948 | 2.3576457 |
| 1591 | 24.796331 | 26.548541 | 6.546525 |     SMQ |   11.642715 | 1.9600588 |
| 1601 | 25.881492 | 23.083956 | 7.570419 |     SMQ |    8.589617 | 3.3918444 |
| 1611 | 38.140421 | 18.170105 | 7.064143 |     SMQ |    9.729882 | 2.6654502 |
| 1621 | 44.499707 | 17.773223 | 8.575503 |     SMQ |    8.516848 | 4.2183213 |
| 1631 | 41.801049 | 30.466016 | 8.362883 |     SMQ |   11.668193 | 2.9517936 |
| 1641 | 43.805243 | 18.714468 | 7.256104 |     SMQ |    5.430924 | 4.9954890 |
| 1691 | 10.438687 | 34.330014 | 5.309605 |     SMQ |    9.616838 | 1.6688083 |
| 1701 |  8.052440 | 27.183279 | 9.161863 |     SMQ |   10.740318 | 3.7384085 |
| 1721 | 12.149711 | 29.680107 | 6.772546 |     SMQ |    9.676857 | 2.4967148 |
| 13   |  5.196152 |  9.000000 | 0.000000 |      LX |   11.205629 | 0.0000000 |
| 14   |  5.196152 | 15.000000 | 0.000000 |      LX |    9.931190 | 0.0000000 |
| 15   |  5.196152 | 21.000000 | 0.000000 |      LX |   10.487084 | 0.0000000 |
| 17   |  5.196152 | 27.000000 | 0.000000 |      LX |    7.791627 | 0.0000000 |
| 18   |  5.196152 | 33.000000 | 0.000000 |      LX |   13.014624 | 0.0000000 |
| 20   |  5.196152 | 39.000000 | 0.000000 |      LX |   10.279534 | 0.0000000 |
| 24   |  6.928203 |  6.000000 | 0.000000 |      LX |    8.445801 | 0.0000000 |
| 25   |  8.660254 |  9.000000 | 0.000000 |      LX |    8.941750 | 0.0000000 |
| 26   |  6.928203 | 12.000000 | 0.000000 |      LX |   10.363259 | 0.0000000 |
| 27   |  6.928203 | 18.000000 | 0.000000 |      LX |   10.537240 | 0.0000000 |
| 28   |  8.660254 | 21.000000 | 0.000000 |      LX |    9.454139 | 0.0000000 |
| 29   |  6.928203 | 24.000000 | 0.000000 |      LX |   10.341467 | 0.0000000 |
| 30   |  8.660254 | 33.000000 | 0.000000 |      LX |   10.270938 | 0.0000000 |
| 31   |  6.928203 | 36.000000 | 0.000000 |      LX |   11.050039 | 0.0000000 |
| 32   |  8.660254 | 39.000000 | 0.000000 |      LX |   12.458768 | 0.0000000 |
| 34   | 10.392305 |  6.000000 | 0.000000 |      LX |   10.932602 | 0.0000000 |
| 35   | 12.124356 |  9.000000 | 0.000000 |      LX |    9.509896 | 0.0000000 |
| 36   | 10.392305 | 18.000000 | 0.000000 |      LX |    9.059400 | 0.0000000 |
| 37   | 10.392305 | 24.000000 | 0.000000 |      LX |   11.636255 | 0.0000000 |
| 38   | 12.124356 | 27.000000 | 0.000000 |      LX |   10.290814 | 0.0000000 |
| 39   | 10.392305 | 30.000000 | 0.000000 |      LX |    9.641734 | 0.0000000 |
| 40   | 12.124356 | 33.000000 | 0.000000 |      LX |    9.042822 | 0.0000000 |
| 41   | 12.124356 | 39.000000 | 0.000000 |      LX |   11.606322 | 0.0000000 |
| 42   | 10.392305 | 42.000000 | 0.000000 |      LX |   11.719441 | 0.0000000 |
| 47   | 13.856406 |  6.000000 | 0.000000 |      LX |   11.150673 | 0.0000000 |
| 48   | 15.588457 |  9.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 49   | 13.856406 | 12.000000 | 0.000000 |      LX |   11.474028 | 0.0000000 |
| 50   | 15.588457 | 15.000000 | 0.000000 |      LX |    7.993627 | 0.0000000 |
| 51   | 13.856406 | 18.000000 | 0.000000 |      LX |    9.424652 | 0.0000000 |
| 52   | 15.588457 | 21.000000 | 0.000000 |      LX |   11.507604 | 0.0000000 |
| 53   | 13.856406 | 24.000000 | 0.000000 |      LX |   11.595264 | 0.0000000 |
| 54   | 15.588457 | 27.000000 | 0.000000 |      LX |   10.156164 | 0.0000000 |
| 55   | 15.588457 | 33.000000 | 0.000000 |      LX |   15.387333 | 0.0000000 |
| 56   | 13.856406 | 36.000000 | 0.000000 |      LX |   10.985818 | 0.0000000 |
| 57   | 15.588457 | 39.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 58   | 13.856406 | 42.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 62   | 17.320508 |  6.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 63   | 19.052559 |  9.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 64   | 17.320508 | 12.000000 | 0.000000 |      LX |    9.863137 | 0.0000000 |
| 65   | 17.320508 | 18.000000 | 0.000000 |      LX |   10.279225 | 0.0000000 |
| 66   | 19.052559 | 21.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 67   | 17.320508 | 24.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 68   | 19.052559 | 27.000000 | 0.000000 |      LX |    9.147094 | 0.0000000 |
| 69   | 17.320508 | 36.000000 | 0.000000 |      LX |   11.169831 | 0.0000000 |
| 70   | 19.052559 | 39.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 71   | 17.320508 | 42.000000 | 0.000000 |      LX |    8.904656 | 0.0000000 |
| 74   | 20.784610 |  6.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 75   | 22.516660 |  9.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 76   | 20.784610 | 12.000000 | 0.000000 |      LX |   11.104262 | 0.0000000 |
| 77   | 22.516660 | 15.000000 | 0.000000 |      LX |   11.435027 | 0.0000000 |
| 78   | 20.784610 | 18.000000 | 0.000000 |      LX |   11.250807 | 0.0000000 |
| 79   | 22.516660 | 21.000000 | 0.000000 |      LX |   11.176787 | 0.0000000 |
| 80   | 20.784610 | 24.000000 | 0.000000 |      LX |   11.687905 | 0.0000000 |
| 81   | 22.516660 | 27.000000 | 0.000000 |      LX |    9.448145 | 0.0000000 |
| 82   | 20.784610 | 30.000000 | 0.000000 |      LX |   12.309025 | 0.0000000 |
| 83   | 22.516660 | 33.000000 | 0.000000 |      LX |    8.725914 | 0.0000000 |
| 84   | 20.784610 | 36.000000 | 0.000000 |      LX |    8.867912 | 0.0000000 |
| 85   | 22.516660 | 39.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 86   | 20.784610 | 42.000000 | 0.000000 |      LX |    9.325039 | 0.0000000 |
| 90   | 24.248711 |  6.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 91   | 25.980762 |  9.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 92   | 24.248711 | 12.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 93   | 25.980762 | 15.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 94   | 24.248711 | 18.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 95   | 25.980762 | 21.000000 | 0.000000 |      LX |    7.542007 | 0.0000000 |
| 96   | 24.248711 | 30.000000 | 0.000000 |      LX |   10.584336 | 0.0000000 |
| 97   | 25.980762 | 33.000000 | 0.000000 |      LX |   10.792628 | 0.0000000 |
| 98   | 24.248711 | 36.000000 | 0.000000 |      LX |   11.531092 | 0.0000000 |
| 99   | 25.980762 | 39.000000 | 0.000000 |      LX |   11.048694 | 0.0000000 |
| 100  | 24.248711 | 42.000000 | 0.000000 |      LX |   11.580240 | 0.0000000 |
| 105  | 27.712813 |  6.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 106  | 29.444864 |  9.000000 | 0.000000 |      LX |   11.171642 | 0.0000000 |
| 107  | 27.712813 | 12.000000 | 0.000000 |      LX |   11.624945 | 0.0000000 |
| 108  | 29.444864 | 15.000000 | 0.000000 |      LX |    9.932131 | 0.0000000 |
| 109  | 27.712813 | 18.000000 | 0.000000 |      LX |   10.199212 | 0.0000000 |
| 110  | 27.712813 | 24.000000 | 0.000000 |      LX |    9.487568 | 0.0000000 |
| 111  | 29.444864 | 27.000000 | 0.000000 |      LX |   11.400549 | 0.0000000 |
| 112  | 27.712813 | 30.000000 | 0.000000 |      LX |   11.327452 | 0.0000000 |
| 113  | 29.444864 | 33.000000 | 0.000000 |      LX |    8.419238 | 0.0000000 |
| 117  | 31.176915 |  6.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 118  | 32.908965 |  9.000000 | 0.000000 |      LX |    9.323568 | 0.0000000 |
| 119  | 32.908965 | 15.000000 | 0.000000 |      LX |    9.416982 | 0.0000000 |
| 120  | 31.176915 | 24.000000 | 0.000000 |      LX |    9.995681 | 0.0000000 |
| 121  | 32.908965 | 27.000000 | 0.000000 |      LX |   11.299328 | 0.0000000 |
| 122  | 31.176915 | 30.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 123  | 32.908965 | 33.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 124  | 31.176915 | 36.000000 | 0.000000 |      LX |    9.329812 | 0.0000000 |
| 125  | 31.176915 | 42.000000 | 0.000000 |      LX |    7.965721 | 0.0000000 |
| 130  | 34.641016 |  6.000000 | 0.000000 |      LX |   10.392305 | 0.0000000 |
| 131  | 36.373067 |  9.000000 | 0.000000 |      LX |    9.937463 | 0.0000000 |
| 132  | 34.641016 | 12.000000 | 0.000000 |      LX |    7.369184 | 0.0000000 |
| 133  | 34.641016 | 18.000000 | 0.000000 |      LX |   12.662023 | 0.0000000 |
| 134  | 36.373067 | 21.000000 | 0.000000 |      LX |   11.090967 | 0.0000000 |
| 135  | 34.641016 | 24.000000 | 0.000000 |      LX |    7.685084 | 0.0000000 |
| 136  | 34.641016 | 30.000000 | 0.000000 |      LX |   11.711396 | 0.0000000 |
| 137  | 36.373067 | 33.000000 | 0.000000 |      LX |    9.306858 | 0.0000000 |
| 138  | 34.641016 | 36.000000 | 0.000000 |      LX |   11.346602 | 0.0000000 |
| 139  | 36.373067 | 39.000000 | 0.000000 |      LX |   11.662031 | 0.0000000 |
| 140  | 34.641016 | 42.000000 | 0.000000 |      LX |   11.422456 | 0.0000000 |
| 144  | 38.105118 |  6.000000 | 0.000000 |      LX |   10.921498 | 0.0000000 |
| 145  | 39.837169 | 15.000000 | 0.000000 |      LX |   10.247703 | 0.0000000 |
| 146  | 39.837169 | 27.000000 | 0.000000 |      LX |   11.925154 | 0.0000000 |
| 147  | 38.105118 | 30.000000 | 0.000000 |      LX |   12.572817 | 0.0000000 |
| 148  | 38.105118 | 36.000000 | 0.000000 |      LX |    8.814463 | 0.0000000 |
| 149  | 39.837169 | 39.000000 | 0.000000 |      LX |    8.639125 | 0.0000000 |
| 153  | 43.301270 |  9.000000 | 0.000000 |      LX |    9.187869 | 0.0000000 |
| 154  | 41.569219 | 12.000000 | 0.000000 |      LX |   12.267260 | 0.0000000 |
| 155  | 41.569219 | 18.000000 | 0.000000 |      LX |    5.920901 | 0.0000000 |
| 156  | 43.301270 | 21.000000 | 0.000000 |      LX |    8.772850 | 0.0000000 |
| 157  | 41.569219 | 24.000000 | 0.000000 |      LX |   12.939535 | 0.0000000 |
| 158  | 43.301270 | 27.000000 | 0.000000 |      LX |   10.707339 | 0.0000000 |
| 159  | 43.301270 | 33.000000 | 0.000000 |      LX |   10.697504 | 0.0000000 |
| 160  | 41.569219 | 36.000000 | 0.000000 |      LX |   10.763383 | 0.0000000 |
| 161  | 43.301270 | 39.000000 | 0.000000 |      LX |   10.889871 | 0.0000000 |
| 162  | 41.569219 | 42.000000 | 0.000000 |      LX |    8.795413 | 0.0000000 |

### **2.9 Plot.Voronoi.LAI(minx,maxx,miny,maxy,boundary,b,r)**

2.9.1功能介绍：

基于泰森多边形法计算单层林或复层林内单一林层的林地内各位置的叶面积指数，并绘图。

2.9.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

b—样地中的林木坐标、树种、胸径

r—将在林分中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为添加样点构成泰森多边形外接圆的半径

2.9.3例：

```R
b=Broadleaf.Korean.pine.LAI::b
b=subset(b,b$H>20 & b$H<30)
b=b[,-4]
head(b)
##           x         y      DBH Species
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
## 7 18.299115 36.464101 31.79671      HS
## 8 25.667076  4.623330 31.56699      HS
p=Broadleaf.Korean.pine.LAI::Plot.Voronoi.LAI(minx=0,maxx=50,miny=0,maxy=50,boundary=5,b=b,r=3.5)
p1=p+geom_point(data=b,aes(x=x,y=y),size=b$DBH/8,col="grey4",alpha=0.2)
p1
```

![2.9.1](https://github.com/DuXinChina/Broadleaf.Korean.pine.LAI/blob/main/handbook/assets/2.9.1.png)

### 2.10 Single.point.Voronoi.LAI(minx,maxx,miny,maxy,boundary,a,b,r)

2.10.1功能介绍：

基于泰森多边形法计算单层林或复层林内单一林层的林地内任意单一位点的叶面积指数。

2.10.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

a—需要计算叶面积指数的位点的坐标

b—样地中的林木坐标、树种、胸径

r—将在林分中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为添加样点构成泰森多边形外接圆的半径

2.10.3例：

```R
a=matrix(runif(2,5,45),1,2)
colnames(a)=c("x","y")
a=as.data.frame(a)
a
##          x        y
## 1 24.19606 44.30672
b=Broadleaf.Korean.pine.LAI::b
b=subset(b,b$H>20 & b$H<30)
b=b[,-4]
head(b)
##           x         y      DBH Species
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
## 7 18.299115 36.464101 31.79671      HS
## 8 25.667076  4.623330 31.56699      HS
result=Broadleaf.Korean.pine.LAI::Single.point.Voronoi.LAI(minx=0,maxx=50,miny=0,maxy=50,boundary=5,a=a,b=b,r=3.5)
formattable::formattable(result)
```

|      |   pointx |    treex | treey | Species |  LAI |
| :--- | -------: | -------: | ----: | ------: | ---: |
| 30   | 24.19606 | 24.24871 |    42 |      LX |    0 |

### 2.11 mult.point.Voronoi.LAI(minx,maxx,miny,maxy,boundary,a,b,r)

2.11.1功能介绍：

基于泰森多边形法计算单层林或复层林内单一林层的林地内任意多个位点的叶面积指数。

2.11.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

a—需要计算叶面积指数的位点坐标

b—样地中的林木坐标、树种、胸径

r—将在林分中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为添加样点构成泰森多边形外接圆的半径

2.11.3例：

```R
set.seed(100)
a=matrix(runif(40,5,45),20,2)
colnames(a)=c("x","y")
a=as.data.frame(a)
head(a)
##           x        y
## 1 17.310644 26.43245
## 2 15.306900 33.43215
## 3 27.092897 26.53395
## 4  7.255326 34.95889
## 5 23.741971 21.80406
## 6 24.350829 11.85681
b=Broadleaf.Korean.pine.LAI::b
b=subset(b,b$H>20 & b$H<30)
b=b[,-4]
head(b)
##           x         y      DBH Species
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
## 7 18.299115 36.464101 31.79671      HS
## 8 25.667076  4.623330 31.56699      HS
result=Broadleaf.Korean.pine.LAI::mult.point.Voronoi.LAI(minx=0,maxx=50,miny=0,maxy=50,boundary=5,a=a,b=b,r=3.5)
formattable::formattable(result)
```

|    pointx |   pointy |     treex |    treey | Species |       LAI |
| --------: | -------: | --------: | -------: | ------: | --------: |
| 17.310644 | 26.43245 | 16.311369 | 25.04853 |      LS |  9.870434 |
| 15.306900 | 33.43215 | 15.155445 | 36.75000 |      LX |  0.000000 |
| 27.092897 | 26.53395 | 27.279800 | 26.25000 |      LX |  0.000000 |
|  7.255326 | 34.95889 | 10.188092 | 36.03751 |      ZD | 16.331710 |
| 23.741971 | 21.80406 | 24.248711 | 21.00000 |      LX |  0.000000 |
| 24.350829 | 11.85681 | 22.677173 | 12.86923 |      HS | 24.021798 |
| 37.496105 | 35.81206 | 37.094858 | 34.35328 |      ZD | 13.288625 |
| 19.812821 | 40.27814 | 18.186533 | 42.00000 |      LX |  0.000000 |
| 26.862344 | 26.96387 | 27.279800 | 26.25000 |      LX |  0.000000 |
| 11.810482 | 16.10895 |  9.093267 | 15.75000 |      LX |  0.000000 |
| 29.999859 | 24.53224 | 27.279800 | 26.25000 |      LX |  0.000000 |
| 40.286621 | 42.14020 | 42.435245 | 42.00000 |      LX |  0.000000 |
| 16.214154 | 18.94768 | 18.146064 | 19.26605 |      HS | 46.764071 |
| 20.939516 | 43.16631 | 18.186533 | 42.00000 |      LX |  0.000000 |
| 35.502043 | 32.81097 | 37.094858 | 34.35328 |      ZD | 13.288625 |
| 31.760868 | 40.57814 | 30.310889 | 42.00000 |      LX |  0.000000 |
| 13.184486 | 12.21629 | 10.921241 | 11.59234 |      HS | 11.607436 |
| 19.300994 | 30.17563 | 18.186533 | 31.50000 |      LX |  0.000000 |
| 19.379005 | 44.58257 | 18.186533 | 42.00000 |      LX |  0.000000 |
| 32.611621 | 10.21155 | 36.373067 | 10.50000 |      LX |  0.000000 |

### 2.12 Local.single.point.Voronoi.LAI(minx,maxx,miny,maxy,boundary,a,b,r,Lr)

2.12.1功能介绍：

基于泰森多边形法计算单层林或复层林内单一林层的林地内任意单一位点的与叶面积有关的局部冠层结构参数。

2.12.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

a—需要模拟局部冠层结构参数的位置坐标

b—样地中的林木坐标、树种、胸径

r—将在林分中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为添加样点构成泰森多边形外接圆的半径

Lr—提取局部冠层结构参数时的圆的半径

2.12.3例：

```R
set.seed(100)
a=matrix(runif(2,5,45),1,2)
colnames(a)=c("x","y")
a=as.data.frame(a)
a
##          x       y
## 1 17.31064 15.3069
b=Broadleaf.Korean.pine.LAI::b
b=subset(b,b$H>20 & b$H<30)
b=b[,-4]
head(b)
##           x         y      DBH Species
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
## 7 18.299115 36.464101 31.79671      HS
## 8 25.667076  4.623330 31.56699      HS
result=Broadleaf.Korean.pine.LAI::Local.single.point.Voronoi.LAI(minx=0,maxx=50,miny=0,maxy=50,boundary=5,a=a,b=b,r=3.5,Lr=1.5)
formattable::formattable(result)
```

|        x |       y |      LAI | Local_min_LAI | Local_max_LAI | Local_mean_LAI | Local_sd_LAI | Gap_percent | Canopy_percent | N_L_Percent | B_L_Percent |
| -------: | ------: | -------: | ------------: | ------------: | -------------: | -----------: | ----------: | -------------: | ----------: | ----------: |
| 17.31064 | 15.3069 | 18.28993 |             0 |      46.76407 |       16.04435 |     6.770815 |    0.134058 |       0.865942 |  0.02112084 |   0.9788792 |

### 2.13 Local.mult.point.Voronoi.LAI(minx,maxx,miny,maxy,boundary,a,b,r,Lr)

2.13.1功能介绍：

基于泰森多边形法计算单层林或复层林内单一林层的林地内任意多个位点的与叶面积有关的局部冠层结构参数。

2.13.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

a—需要模拟局部冠层结构参数的位置坐标

b—样地中的林木坐标、树种、胸径

r—将在林分中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为添加样点构成泰森多边形外接圆的半径

Lr—提取局部冠层结构参数时的圆的半径

2.13.3例：

```R
set.seed(100)
a=matrix(runif(40,5,45),20,2)
colnames(a)=c("x","y")
a=as.data.frame(a)
head(a)
##           x        y
## 1 17.310644 26.43245
## 2 15.306900 33.43215
## 3 27.092897 26.53395
## 4  7.255326 34.95889
## 5 23.741971 21.80406
## 6 24.350829 11.85681
b=Broadleaf.Korean.pine.LAI::b
b=subset(b,b$H>20 & b$H<30)
b=b[,-4]
head(b)
##           x         y      DBH Species
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
## 7 18.299115 36.464101 31.79671      HS
## 8 25.667076  4.623330 31.56699      HS
result=Broadleaf.Korean.pine.LAI::Local.mult.point.Voronoi.LAI(minx=0,maxx=50,miny=0,maxy=50,boundary=5,a=a,b=b,r=3.5,Lr=1.5)
formattable::formattable(result)
```

|         x |        y |       LAI | Local_min_LAI | Local_max_LAI | Local_mean_LAI | Local_sd_LAI | Gap_percent | Canopy_percent | N_L_Percent | B_L_Percent |
| --------: | -------: | --------: | ------------: | ------------: | -------------: | -----------: | ----------: | -------------: | ----------: | ----------: |
| 17.310644 | 26.43245 |  9.870434 |      0.000000 |      9.870434 |      9.4770471 |     1.934348 | 0.039855072 |     0.96014493 |   1.0000000 |  0.00000000 |
| 15.306900 | 33.43215 |  0.000000 |      0.000000 |      0.000000 |      0.0000000 |     0.000000 | 1.000000000 |     0.00000000 |         NaN |         NaN |
| 27.092897 | 26.53395 |  0.000000 |      0.000000 |      0.000000 |      0.0000000 |     0.000000 | 1.000000000 |     0.00000000 |         NaN |         NaN |
|  7.255326 | 34.95889 | 16.331710 |     16.331710 |     16.331710 |     16.3317104 |     0.000000 | 0.000000000 |     1.00000000 |   0.0000000 |  1.00000000 |
| 23.741971 | 21.80406 |  0.000000 |      0.000000 |      0.000000 |      0.0000000 |     0.000000 | 1.000000000 |     0.00000000 |         NaN |         NaN |
| 24.350829 | 11.85681 | 24.021798 |      8.411215 |     80.321326 |     29.7941429 |    18.944875 | 0.000000000 |     1.00000000 |   0.6460336 |  0.35396638 |
| 37.496105 | 35.81206 | 13.288625 |      0.000000 |     13.288625 |      8.6183474 |     6.355819 | 0.351449275 |     0.64855072 |   0.0000000 |  1.00000000 |
| 19.812821 | 40.27814 |  0.000000 |      0.000000 |      7.624945 |      0.8564250 |     2.412013 | 0.887681159 |     0.11231884 |   1.0000000 |  0.00000000 |
| 26.862344 | 26.96387 |  0.000000 |      0.000000 |      0.000000 |      0.0000000 |     0.000000 | 1.000000000 |     0.00000000 |         NaN |         NaN |
| 11.810482 | 16.10895 |  0.000000 |      0.000000 |     18.289925 |      6.1629095 |     8.660801 | 0.663043478 |     0.33695652 |   0.0000000 |  1.00000000 |
| 29.999859 | 24.53224 |  0.000000 |      0.000000 |     22.774307 |      8.5816227 |    11.056182 | 0.623188406 |     0.37681159 |   0.0000000 |  1.00000000 |
| 40.286621 | 42.14020 |  0.000000 |      0.000000 |      0.000000 |      0.0000000 |     0.000000 | 1.000000000 |     0.00000000 |         NaN |         NaN |
| 16.214154 | 18.94768 | 46.764071 |      0.000000 |     46.764071 |     38.4546345 |    13.238150 | 0.007246377 |     0.99275362 |   0.8707545 |  0.12924550 |
| 20.939516 | 43.16631 |  0.000000 |      0.000000 |      0.000000 |      0.0000000 |     0.000000 | 1.000000000 |     0.00000000 |         NaN |         NaN |
| 35.502043 | 32.81097 | 13.288625 |     13.288625 |     13.288625 |     13.2886250 |     0.000000 | 0.000000000 |     1.00000000 |   0.0000000 |  1.00000000 |
| 31.760868 | 40.57814 |  0.000000 |      0.000000 |      5.659673 |      0.4716394 |     1.567092 | 0.916666667 |     0.08333333 |   1.0000000 |  0.00000000 |
| 13.184486 | 12.21629 | 11.607436 |     11.607436 |     18.289925 |     11.9948264 |     1.564459 | 0.000000000 |     1.00000000 |   0.9116048 |  0.08839524 |
| 19.300994 | 30.17563 |  0.000000 |      0.000000 |      0.000000 |      0.0000000 |     0.000000 | 1.000000000 |     0.00000000 |         NaN |         NaN |
| 19.379005 | 44.58257 |  0.000000 |      0.000000 |      0.000000 |      0.0000000 |     0.000000 | 1.000000000 |     0.00000000 |         NaN |         NaN |
| 32.611621 | 10.21155 |  0.000000 |      0.000000 |     80.321326 |     12.1671443 |    15.891587 | 0.528985507 |     0.47101449 |   0.0000000 |  1.00000000 |

### 2.14 Semivariogram.Voronoi.LAI.Single(minx,maxx,miny,maxy,boundary,b,r,seq)

2.14.1功能介绍：

基于泰森多边形法模拟单层林或复层林内单一林层的叶面积指数的半变异函数

2.14.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

b—样地中的林木坐标、树种、胸径

r—将在林分中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为添加样点构成泰森多边形外接圆的半径

seq—模拟半变异函数时的空间分辨率

2.14.3例：

```R
b=Broadleaf.Korean.pine.LAI::b
b=subset(b,b$H>20 & b$H<30)
b=b[,-4]
head(b)
##           x         y      DBH Species
## 3 18.146064 19.266050 52.26441      HS
## 4 27.592828 13.896808 32.36649      HS
## 5  6.108164 25.639671 35.55580      HS
## 6 39.511178  5.185569 53.03717      HS
## 7 18.299115 36.464101 31.79671      HS
## 8 25.667076  4.623330 31.56699      HS
Broadleaf.Korean.pine.LAI::Semivariogram.Voronoi.LAI.Single(minx=0,maxx=50,miny=0,maxy=50,boundary=5,b=b,r=3.5,seq=20)
##   model    psill    range
## 1   Nug  0.00000 0.000000
## 2   Sph 97.11761 6.263462
```

![2.14.1](https://github.com/DuXinChina/Broadleaf.Korean.pine.LAI/blob/main/handbook/assets/2.14.1.png)

```R
## [1] "Coefficient_of_Determination= 0.949030801598704"
```

### 2.15 Plot.Voronoi.LAI.Sum(minx,maxx,miny,maxy,boundary,b,strata,r)

2.15.1功能介绍：

基于分层泰森多边形法绘制复层林林分叶面积指数图

2.15.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

b—样地中的林木坐标、树种、胸径

strata—不同林层间的分割高度

r—将在林分各林层中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为不同林层添加样点构成泰森多边形外接圆的半径

2.15.3例：

```R
b=Broadleaf.Korean.pine.LAI::b
head(b)
##           x         y      DBH  H Species
## 1 33.428848 18.981981 65.58075 35      HS
## 2  6.434608 42.039176 66.18077 35      HS
## 3 18.146064 19.266050 52.26441 25      HS
## 4 27.592828 13.896808 32.36649 25      HS
## 5  6.108164 25.639671 35.55580 25      HS
## 6 39.511178  5.185569 53.03717 25      HS
p=Broadleaf.Korean.pine.LAI::Plot.Voronoi.LAI.Sum(minx=0,maxx=50,miny=0,maxy=50,boundary=5,b=b,strata=c(10,16,30),r=c(2,2.5,3.5,4))
p1=p+geom_vline(xintercept = c(5,45),linetype=2)+geom_hline(yintercept =c(5,45),linetype=2)
p1=p+scale_x_continuous(expand= c(0, 5))+scale_y_continuous(expand= c(0, 5))
## Scale for 'x' is already present. Adding another scale for 'x', which will
## replace the existing scale.
## Scale for 'y' is already present. Adding another scale for 'y', which will
## replace the existing scale.
p2=p1+geom_point(data=b,aes(x=x,y=y),size=b$DBH/8,col="grey4",alpha=0.2)+scale_x_continuous(expand= c(0, 0))+scale_y_continuous(expand= c(0, 0))
## Scale for 'x' is already present. Adding another scale for 'x', which will
## replace the existing scale.
## Scale for 'y' is already present. Adding another scale for 'y', which will
## replace the existing scale.
p2
```

![2.15.1](https://github.com/DuXinChina/Broadleaf.Korean.pine.LAI/blob/main/handbook/assets/2.15.1.png)

### 2.16 Single.point.Voronoi.LAI.sum(minx,maxx,miny,maxy,boundary,a,b,strata,r)

2.16.1功能介绍：

基于分层泰森多边形法计算复层林内单一任意位点的叶面积指数

2.16.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

a—需要计算叶面积指数的位点的坐标

b—样地中的林木坐标、树种、胸径

strata—不同林层间的分割高度

r—将在林分各林层中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为不同林层添加样点构成泰森多边形外接圆的半径

2.16.3例：

```R
set.seed(100)
a=matrix(runif(2,5,45),1,2)
colnames(a)=c("x","y")
a=as.data.frame(a)
a
##          x       y
## 1 17.31064 15.3069
b=Broadleaf.Korean.pine.LAI::b
head(b)
##           x         y      DBH  H Species
## 1 33.428848 18.981981 65.58075 35      HS
## 2  6.434608 42.039176 66.18077 35      HS
## 3 18.146064 19.266050 52.26441 25      HS
## 4 27.592828 13.896808 32.36649 25      HS
## 5  6.108164 25.639671 35.55580 25      HS
## 6 39.511178  5.185569 53.03717 25      HS
result=Broadleaf.Korean.pine.LAI::Single.point.Voronoi.LAI.sum(minx=0,maxx=50,miny=0,maxy=50,boundary=5,a=a,b=b,strata=c(10,16,30),r=c(2,2.5,3.5,4))
formattable::formattable(result)
```

|      |        x |       y | Species |      LAI |   SumLAI | Strata_cont |
| :--- | -------: | ------: | ------: | -------: | -------: | ----------: |
| 1291 | 17.31064 | 15.3069 |      HS | 1.843061 | 20.13299 |    1.126765 |

### 2.17 mult.point.Voronoi.LAI.sum(minx,maxx,miny,maxy,boundary,a,b,strata,r)

2.17.1功能介绍：

基于分层泰森多边形法计算复层林内多个任意位点的叶面积指数

2.17.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

a—需要计算叶面积指数的位点的坐标

b—样地中的林木坐标、树种、胸径

strata—不同林层间的分割高度

r—将在林分各林层中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为不同林层添加样点构成泰森多边形外接圆的半径

2.17.3 例：

```R
set.seed(100)
a=matrix(runif(40,5,45),20,2)
colnames(a)=c("x","y")
a=as.data.frame(a)
a
##            x        y
## 1  17.310644 26.43245
## 2  15.306900 33.43215
## 3  27.092897 26.53395
## 4   7.255326 34.95889
## 5  23.741971 21.80406
## 6  24.350829 11.85681
## 7  37.496105 35.81206
## 8  19.812821 40.27814
## 9  26.862344 26.96387
## 10 11.810482 16.10895
## 11 29.999859 24.53224
## 12 40.286621 42.14020
## 13 16.214154 18.94768
## 14 20.939516 43.16631
## 15 35.502043 32.81097
## 16 31.760868 40.57814
## 17 13.184486 12.21629
## 18 19.300994 30.17563
## 19 19.379005 44.58257
## 20 32.611621 10.21155
b=Broadleaf.Korean.pine.LAI::b
head(b)
##           x         y      DBH  H Species
## 1 33.428848 18.981981 65.58075 35      HS
## 2  6.434608 42.039176 66.18077 35      HS
## 3 18.146064 19.266050 52.26441 25      HS
## 4 27.592828 13.896808 32.36649 25      HS
## 5  6.108164 25.639671 35.55580 25      HS
## 6 39.511178  5.185569 53.03717 25      HS
result=Broadleaf.Korean.pine.LAI::mult.point.Voronoi.LAI.sum(minx=0,maxx=50,miny=0,maxy=50,boundary=5,a=a,b=b,strata=c(10,16,30),r=c(2,2.5,3.5,4))
formattable::formattable(result)
```

|         x |        y | Species |      LAI |    SumLAI | Strata_cont |
| --------: | -------: | ------: | -------: | --------: | ----------: |
| 17.310644 | 26.43245 |      LX | 0.000000 |  9.870434 |   1.2000000 |
| 15.306900 | 33.43215 |      LX | 0.000000 |  0.000000 |         NaN |
| 27.092897 | 26.53395 |     SMQ | 1.960059 | 13.295752 |   0.7410320 |
|  7.255326 | 34.95889 |      LX | 0.000000 | 23.730792 |   1.0752830 |
| 23.741971 | 21.80406 |      LX | 0.000000 |  0.000000 |         NaN |
| 24.350829 | 11.85681 |      LX | 0.000000 | 24.021798 |   1.2000000 |
| 37.496105 | 35.81206 |      LX | 0.000000 | 13.288625 |   1.2000000 |
| 19.812821 | 40.27814 |      LX | 0.000000 |  0.000000 |         NaN |
| 26.862344 | 26.96387 |     SMQ | 1.960059 |  1.960059 |   0.4000000 |
| 11.810482 | 16.10895 |      HS | 4.848732 |  4.848732 |   0.4000000 |
| 29.999859 | 24.53224 |      LX | 0.000000 | 11.335693 |   0.8000000 |
| 40.286621 | 42.14020 |      LX | 0.000000 |  0.000000 |         NaN |
| 16.214154 | 18.94768 |      LX | 0.000000 | 46.764071 |   1.2000000 |
| 20.939516 | 43.16631 |      LX | 0.000000 |  6.476124 |   0.8000000 |
| 35.502043 | 32.81097 |      LX | 0.000000 | 13.288625 |   1.2000000 |
| 31.760868 | 40.57814 |      ZD | 1.209761 |  1.209761 |   0.4000000 |
| 13.184486 | 12.21629 |      LX | 0.000000 | 11.607436 |   1.2000000 |
| 19.300994 | 30.17563 |      LX | 0.000000 |  0.000000 |         NaN |
| 19.379005 | 44.58257 |      ZD | 3.272128 |  9.748252 |   0.6657348 |
| 32.611621 | 10.21155 |      HS | 2.558918 | 10.988903 |   0.7068545 |

### 2.18 Local.single.point.Voronoi.LAI.sum(minx,maxx,miny,maxy,boundary,a,b,strata,r,Lr)

2.18.1功能介绍：

基于分层泰森多边形法计算复层林内单一任意位点的与叶面积指数相关的局部冠层结构特征

2.18.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

a—需要模拟局部冠层结构参数的位点的坐标

b—样地中的林木坐标、树种、胸径

strata—不同林层间的分割高度

r—将在林分各林层中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为不同林层添加样点构成泰森多边形外接圆的半径

Lr—模拟局部冠层结构参数的圆的半径

2.18.3 例：

```R
set.seed(100)
a=matrix(runif(2,5,45),1,2)
colnames(a)=c("x","y")
a=as.data.frame(a)
a
##          x       y
## 1 17.31064 15.3069
b=Broadleaf.Korean.pine.LAI::b
head(b)
##           x         y      DBH  H Species
## 1 33.428848 18.981981 65.58075 35      HS
## 2  6.434608 42.039176 66.18077 35      HS
## 3 18.146064 19.266050 52.26441 25      HS
## 4 27.592828 13.896808 32.36649 25      HS
## 5  6.108164 25.639671 35.55580 25      HS
## 6 39.511178  5.185569 53.03717 25      HS
result=Broadleaf.Korean.pine.LAI::Local.single.point.Voronoi.LAI.sum(minx=0,maxx=50,miny=0,maxy=50,boundary=5,a=a,b=b,strata=c(10,16,30),r=c(2,2.5,3.5,4),Lr=1.5)
formattable::formattable(result)
```

|        x |       y |      LAI | Local_min_LAI | Local_max_LAI | Local_mean_LAI | Local_sd_LAI | Gap_percent | Canopy_percent | N_L_Percent | B_L_Percent | Strata_cont |
| -------: | ------: | -------: | ------------: | ------------: | -------------: | -----------: | ----------: | -------------: | ----------: | ----------: | ----------: |
| 17.31064 | 15.3069 | 20.13299 |      1.843061 |      48.60713 |       17.29617 |     6.640205 |           0 |              1 |  0.09251101 |    0.907489 |    1.141722 |

### 2.19 Local.mult.point.Voronoi.LAI.sum(minx,maxx,miny,maxy,boundary,a,b,strata,r,Lr)

2.19.1功能介绍：

基于分层泰森多边形法计算复层林内多个任意位点的与叶面积指数相关的局部冠层结构特征

2.19.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

a—需要模拟局部冠层结构参数的位点的坐标

b—样地中的林木坐标、树种、胸径

strata—不同林层间的分割高度

r—将在林分各林层中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为不同林层添加样点构成泰森多边形外接圆的半径

Lr—模拟局部冠层结构参数的圆的半径

2.19.3 例：

```R
set.seed(100)
a=matrix(runif(40,5,45),20,2)
colnames(a)=c("x","y")
a=as.data.frame(a)
a
##            x        y
## 1  17.310644 26.43245
## 2  15.306900 33.43215
## 3  27.092897 26.53395
## 4   7.255326 34.95889
## 5  23.741971 21.80406
## 6  24.350829 11.85681
## 7  37.496105 35.81206
## 8  19.812821 40.27814
## 9  26.862344 26.96387
## 10 11.810482 16.10895
## 11 29.999859 24.53224
## 12 40.286621 42.14020
## 13 16.214154 18.94768
## 14 20.939516 43.16631
## 15 35.502043 32.81097
## 16 31.760868 40.57814
## 17 13.184486 12.21629
## 18 19.300994 30.17563
## 19 19.379005 44.58257
## 20 32.611621 10.21155
b=Broadleaf.Korean.pine.LAI::b
head(b)
##           x         y      DBH  H Species
## 1 33.428848 18.981981 65.58075 35      HS
## 2  6.434608 42.039176 66.18077 35      HS
## 3 18.146064 19.266050 52.26441 25      HS
## 4 27.592828 13.896808 32.36649 25      HS
## 5  6.108164 25.639671 35.55580 25      HS
## 6 39.511178  5.185569 53.03717 25      HS
result=Broadleaf.Korean.pine.LAI::Local.mult.point.Voronoi.LAI.sum(minx=0,maxx=50,miny=0,maxy=50,boundary=5,a=a,b=b,strata=c(10,16,30),r=c(2,2.5,3.5,4),Lr=1.5)
formattable::formattable(result)
```

|         x |        y |       LAI | Local_min_LAI | Local_max_LAI | Local_mean_LAI | Local_sd_LAI | Gap_percent | Canopy_percent | N_L_Percent | B_L_Percent | Strata_cont |
| --------: | -------: | --------: | ------------: | ------------: | -------------: | -----------: | ----------: | -------------: | ----------: | ----------: | ----------: |
| 17.310644 | 26.43245 |  9.870434 |      0.000000 |     21.696136 |      9.7929634 |     2.250506 | 0.040000000 |      0.9600000 |  0.96759441 |  0.03240559 |   1.1754818 |
| 15.306900 | 33.43215 |  0.000000 |      0.000000 |      0.000000 |      0.0000000 |     0.000000 | 1.000000000 |      0.0000000 |         NaN |         NaN |         NaN |
| 27.092897 | 26.53395 |  0.000000 |      0.000000 |     13.295752 |      8.1716253 |     4.453727 | 0.007272727 |      0.9927273 |  0.00000000 |  1.00000000 |   0.7598777 |
|  7.255326 | 34.95889 | 12.371044 |      7.399082 |     23.730792 |     20.0025186 |     6.070745 | 0.000000000 |      1.0000000 |  0.04519397 |  0.95480603 |   1.0520370 |
| 23.741971 | 21.80406 |  0.000000 |      0.000000 |      3.391844 |      0.6660349 |     1.349856 | 0.803636364 |      0.1963636 |  0.00000000 |  1.00000000 |   0.4000000 |
| 24.350829 | 11.85681 | 24.021798 |      8.411215 |     80.321326 |     30.5935807 |    18.761234 | 0.000000000 |      1.0000000 |  0.62858477 |  0.37141523 |   1.1898221 |
| 37.496105 | 35.81206 | 13.288625 |      0.000000 |     14.327734 |      8.6958290 |     6.437572 | 0.352727273 |      0.6472727 |  0.01086319 |  0.98913681 |   1.1913094 |
| 19.812821 | 40.27814 | 37.960983 |      0.000000 |     37.960983 |     11.9734118 |    15.885760 | 0.632727273 |      0.3672727 |  0.06947161 |  0.93052839 |   0.8277886 |
| 26.862344 | 26.96387 |  1.960059 |      1.960059 |     13.295752 |      7.6557542 |     4.486686 | 0.000000000 |      1.0000000 |  0.00000000 |  1.00000000 |   0.7478642 |
| 11.810482 | 16.10895 |  1.274241 |      0.000000 |     23.138657 |      9.4186189 |     9.632443 | 0.203636364 |      0.7963636 |  0.33000502 |  0.66999498 |   0.9253696 |
| 29.999859 | 24.53224 | 22.774307 |      0.000000 |     34.110000 |     17.2688018 |    10.490200 | 0.076363636 |      0.9236364 |  0.00000000 |  1.00000000 |   0.9975820 |
| 40.286621 | 42.14020 |  3.137152 |      0.000000 |      3.137152 |      1.2736062 |     1.304929 | 0.480000000 |      0.5200000 |  0.57325471 |  0.42674529 |   0.4000000 |
| 16.214154 | 18.94768 | 18.289925 |      0.000000 |     46.764071 |     38.5279608 |    13.206014 | 0.007272727 |      0.9927273 |  0.87225764 |  0.12774236 |   1.2000000 |
| 20.939516 | 43.16631 |  0.000000 |      0.000000 |      9.748252 |      6.5437344 |     2.456450 | 0.090909091 |      0.9090909 |  0.00000000 |  1.00000000 |   0.7584397 |
| 35.502043 | 32.81097 | 13.288625 |     13.288625 |     13.288625 |     13.2886250 |     0.000000 | 0.000000000 |      1.0000000 |  0.00000000 |  1.00000000 |   1.2000000 |
| 31.760868 | 40.57814 |  1.209761 |      0.000000 |      6.869434 |      1.2273915 |     1.799154 | 0.367272727 |      0.6327273 |  0.39069773 |  0.60930227 |   0.7085271 |
| 13.184486 | 12.21629 | 11.607436 |     11.607436 |     18.289925 |     12.0002988 |     1.567572 | 0.000000000 |      1.0000000 |  0.91132378 |  0.08867622 |   1.1997291 |
| 19.300994 | 30.17563 |  2.357646 |      0.000000 |      2.357646 |      0.6172745 |     1.038368 | 0.738181818 |      0.2618182 |  0.00000000 |  1.00000000 |   0.4000000 |
| 19.379005 | 44.58257 |  9.748252 |      1.866460 |      9.748252 |      7.2022863 |     3.014905 | 0.000000000 |      1.0000000 |  0.00000000 |  1.00000000 |   0.6316202 |
| 32.611621 | 10.21155 | 28.567730 |      0.000000 |     91.310229 |     22.2480570 |    15.706171 | 0.003636364 |      0.9963636 |  0.05897266 |  0.94102734 |   0.9946441 |

### 2.20 Semivariogram.Voronoi.LAI(minx,maxx,miny,maxy,boundary,b,strata,r,seq )

2.20.1功能介绍：

基于分层泰森多边形法模拟复层林的叶面积指数的半变异函数

2.20.2参数意义：

minx—样地横坐标最小范围

maxx—样地横坐标最大范围

miny—样地纵坐标最小范围

maxy—样地纵坐标最大范围

boundary—样地边界缓冲区宽度

b—样地中的林木坐标、树种、胸径

r—将在林分中没有林木分布的位置添加样点，以避免以林木为中心的泰森多边形过大。r为添加样点构成泰森多边形外接圆的半径

seq—模拟半变异函数时的空间分辨率

2.20.3例：

```R
b=Broadleaf.Korean.pine.LAI::b
head(b)
##           x         y      DBH  H Species
## 1 33.428848 18.981981 65.58075 35      HS
## 2  6.434608 42.039176 66.18077 35      HS
## 3 18.146064 19.266050 52.26441 25      HS
## 4 27.592828 13.896808 32.36649 25      HS
## 5  6.108164 25.639671 35.55580 25      HS
## 6 39.511178  5.185569 53.03717 25      HS
Broadleaf.Korean.pine.LAI::Semivariogram.Voronoi.LAI(minx=0,maxx=50,miny=0,maxy=50,boundary=5,b=b,strata=c(10,16,30),r=c(2,2.5,3.5,4),seq = 20)
##   model    psill   range
## 1   Nug   0.0000 0.00000
## 2   Sph 146.8565 5.89282
```

![2.20.1](https://github.com/DuXinChina/Broadleaf.Korean.pine.LAI/blob/main/handbook/assets/2.20.1.png)

```R
## [1] "Coefficient_of_Determination= 0.970238996384574"
```